# Image Gallery-1 Challenge Writeup

## Challenge Information
- **Name**: Image Gallery-1
- **Points**: 100
- **Description**: We heard the developer left the flag.txt file in a part of the server, and forgot to properly lock down. Try to reading the file. Link: http://139.162.54.146:5000/
- **Difficulty**: Easy
- **Flag Format**: JKKNIUCTF{s0m3_t3xt}
- **Author**: TM_47

## Initial Analysis
Upon visiting the website, I observed that it had a home page and a gallery section. The most interesting discovery was how images were loaded in the gallery:

```
http://139.162.54.146:5000/view?file=1.png
```

This URL structure showed that the application was using a GET parameter named `file` to retrieve and display images. This immediately suggested a potential Local File Inclusion (LFI) vulnerability, especially since the challenge description mentioned that the developer "forgot to properly lock down" access to files and that a flag.txt file existed somewhere on the server.

## Vulnerability
The vulnerability in this web application is a classic Local File Inclusion (LFI). The application takes user input via the `file` parameter and uses it to read files on the server without proper validation or sanitization. When a web application fails to properly validate file paths, attackers can manipulate these paths to access files outside of the intended directory.

## Exploitation
To exploit this vulnerability, I needed to try to access files outside the intended directory using directory traversal techniques.

Since images were loaded using a relative path (just the filename), I tried to traverse up one directory level to look for the flag file:

```
http://139.162.54.146:5000/view?file=../flag.txt
```

This attempt was successful! The `../` notation allowed me to go up one directory level from where the images were stored, and there I found the flag.txt file. The server responded by displaying the contents of the flag.txt file.

## Key Concepts
This challenge demonstrates several important web security concepts:

1. **Local File Inclusion (LFI)**: A vulnerability that allows attackers to include files on a server through the web browser.
   
2. **Directory Traversal**: Using sequences like `../` to navigate up directory levels and access files outside the intended directory.
   
3. **Improper Input Validation**: The application failed to validate or sanitize user input, allowing manipulation of the file path.
   
4. **Security by Obscurity Failures**: Relying on the assumption that users won't know where sensitive files are located is not a valid security measure.

## Mitigation Strategies
To prevent this type of vulnerability, developers should:

1. Validate and sanitize all user inputs
2. Implement proper access controls
3. Use whitelists for allowed files rather than trying to block malicious inputs
4. Consider using file identifiers/tokens instead of direct file paths

## Flag
The flag for this challenge is: `JKKNIUCTF{this_is_your_flag}`